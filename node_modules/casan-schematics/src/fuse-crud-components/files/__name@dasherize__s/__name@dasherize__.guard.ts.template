import { ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';
import { inject } from '@angular/core';
import { <%= classify(name) %>Service } from 'app/core/<%= dasherize(name) %>/<%= dasherize(name) %>.service';
import { Edit<%= classify(name) %>Component } from './edit/edit.component';

export const CanDeactivateUserEdit = (
    component: Edit<%= classify(name) %>Component,
    currentRoute: ActivatedRouteSnapshot,
    currentState: RouterStateSnapshot,
    nextState: RouterStateSnapshot
  ) => {
  
  const <%= dasherize(name) %>Service = inject(<%= classify(name) %>Service);
  
  let nextRoute: ActivatedRouteSnapshot = nextState.root;
  while (nextRoute.firstChild) {
    nextRoute = nextRoute.firstChild;
  }

  if (!nextState.url.includes('/<%= dasherize(name) %>')) {
    return true;
  }

  if (nextRoute.paramMap.get('id')) {
    return true;
  }

  
  return component.closeDrawer().then(() => {
    <%= dasherize(name) %>Service.<%= dasherize(name) %> = null;
    return true
  });
  
};